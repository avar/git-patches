From 6dc96ba8b826de0f6b130cbb4d899b4fb2116888 Mon Sep 17 00:00:00 2001
Message-Id: <cover-v2-00.25-00000000000-20220325T182519Z-avarab@gmail.com>
In-Reply-To: <cover-00.25-00000000000-20220221T143936Z-avarab@gmail.com>
References: <cover-00.25-00000000000-20220221T143936Z-avarab@gmail.com>
From: Ævar Arnfjörð Bjarmason <avarab@gmail.com>
Date: Fri, 25 Mar 2022 19:25:19 +0100
Subject: [PATCH v2 00/25] *** SUBJECT HERE ***
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

*** BLURB HERE ***

Ævar Arnfjörð Bjarmason (25):
  CI: run "set -ex" early in ci/lib.sh
  CI: make "$jobname" explicit, remove fallback
  CI: remove more dead Travis CI support
  CI: remove dead "tree skipping" code
  CI: remove unused Azure ci/* code
  CI: don't have "git grep" invoke a pager in tree content check
  CI: have "static-analysis" run a "make ci-static-analysis" target
  CI: have "static-analysis" run "check-builtins", not "documentation"
  CI: move p4 and git-lfs variables to ci/install-dependencies.sh
  CI: consistently use "export" in ci/lib.sh
  CI: export variables via a wrapper
  CI: remove "run-build-and-tests.sh", run "make [test]" directly
  CI: check ignored unignored build artifacts in "win[+VS] build" too
  CI: invoke "make artifacts-tar" directly in windows-build
  CI: split up and reduce "ci/test-documentation.sh"
  CI: combine ci/install{,-docker}-dependencies.sh
  CI: move "env" definitions into ci/lib.sh
  ci/run-test-slice.sh: replace shelling out with "echo"
  CI: pre-select test slice in Windows & VS tests
  CI: only invoke ci/lib.sh as "steps" in main.yml
  CI: narrow down variable definitions in --build and --test
  CI: add more variables to MAKEFLAGS, except under vs-build
  CI: set CC in MAKEFLAGS directly, don't add it to the environment
  CI: set PYTHON_PATH setting for osx-{clang,gcc} into "$jobname" case
  CI: don't use "set -x" in "ci/lib.sh" output

 .github/workflows/main.yml            | 100 +++++---
 Makefile                              |  31 ++-
 ci/check-directional-formatting.bash  |   2 +-
 ci/check-unignored-build-artifacts.sh |  20 ++
 ci/install-dependencies.sh            |  53 ++++-
 ci/install-docker-dependencies.sh     |  22 --
 ci/lib-ci-type.sh                     |  10 +
 ci/lib-tput.sh                        |   2 +
 ci/lib.sh                             | 316 +++++++++++++-------------
 ci/make-test-artifacts.sh             |  12 -
 ci/mount-fileshare.sh                 |  25 --
 ci/print-test-failures.sh             |  16 +-
 ci/run-build-and-tests.sh             |  54 -----
 ci/run-docker-build.sh                |  66 ------
 ci/run-docker.sh                      |  47 ----
 ci/run-static-analysis.sh             |  32 ---
 ci/run-test-slice.sh                  |  17 --
 ci/select-test-slice.sh               |  10 +
 ci/test-documentation.sh              |  37 +--
 ci/util/extract-trash-dirs.sh         |  50 ----
 shared.mak                            |   1 +
 21 files changed, 346 insertions(+), 577 deletions(-)
 create mode 100755 ci/check-unignored-build-artifacts.sh
 delete mode 100755 ci/install-docker-dependencies.sh
 create mode 100644 ci/lib-ci-type.sh
 create mode 100644 ci/lib-tput.sh
 delete mode 100755 ci/make-test-artifacts.sh
 delete mode 100755 ci/mount-fileshare.sh
 delete mode 100755 ci/run-build-and-tests.sh
 delete mode 100755 ci/run-docker-build.sh
 delete mode 100755 ci/run-docker.sh
 delete mode 100755 ci/run-static-analysis.sh
 delete mode 100755 ci/run-test-slice.sh
 create mode 100755 ci/select-test-slice.sh
 delete mode 100755 ci/util/extract-trash-dirs.sh

Range-diff against v1:
 1:  4addbd70213 =  1:  4addbd70213 CI: run "set -ex" early in ci/lib.sh
 2:  b23aa99fd37 =  2:  b23aa99fd37 CI: make "$jobname" explicit, remove fallback
 3:  eec15a95879 =  3:  eec15a95879 CI: remove more dead Travis CI support
 4:  73c894f1665 =  4:  73c894f1665 CI: remove dead "tree skipping" code
 5:  b5e6d538554 =  5:  b5e6d538554 CI: remove unused Azure ci/* code
 6:  a4b9febbdca =  6:  a4b9febbdca CI: don't have "git grep" invoke a pager in tree content check
 7:  5d46d5b34c9 =  7:  5d46d5b34c9 CI: have "static-analysis" run a "make ci-static-analysis" target
 8:  81e06f13d84 =  8:  81e06f13d84 CI: have "static-analysis" run "check-builtins", not "documentation"
 9:  3be91c26d44 =  9:  3be91c26d44 CI: move p4 and git-lfs variables to ci/install-dependencies.sh
10:  9dc148341ba = 10:  9dc148341ba CI: consistently use "export" in ci/lib.sh
11:  e9c7ba492e8 = 11:  e9c7ba492e8 CI: export variables via a wrapper
12:  86d5a48d59a = 12:  86d5a48d59a CI: remove "run-build-and-tests.sh", run "make [test]" directly
13:  649ad1ae249 = 13:  649ad1ae249 CI: check ignored unignored build artifacts in "win[+VS] build" too
14:  b1b5b083389 = 14:  b1b5b083389 CI: invoke "make artifacts-tar" directly in windows-build
15:  dfa91ac8938 = 15:  dfa91ac8938 CI: split up and reduce "ci/test-documentation.sh"
16:  ba4ed216769 = 16:  ba4ed216769 CI: combine ci/install{,-docker}-dependencies.sh
17:  b5e89a33340 = 17:  b5e89a33340 CI: move "env" definitions into ci/lib.sh
18:  571f4d0f441 = 18:  571f4d0f441 ci/run-test-slice.sh: replace shelling out with "echo"
19:  2edea06ee4d = 19:  2edea06ee4d CI: pre-select test slice in Windows & VS tests
20:  ef9daa6882f = 20:  ef9daa6882f CI: only invoke ci/lib.sh as "steps" in main.yml
21:  44e3ace5fbe = 21:  44e3ace5fbe CI: narrow down variable definitions in --build and --test
22:  5f56b922e08 = 22:  5f56b922e08 CI: add more variables to MAKEFLAGS, except under vs-build
23:  b45b7cec94e = 23:  b45b7cec94e CI: set CC in MAKEFLAGS directly, don't add it to the environment
24:  06bf8d9f61b = 24:  06bf8d9f61b CI: set PYTHON_PATH setting for osx-{clang,gcc} into "$jobname" case
25:  6dc96ba8b82 = 25:  6dc96ba8b82 CI: don't use "set -x" in "ci/lib.sh" output
-- 
2.35.1.1517.g20a06c426a7

