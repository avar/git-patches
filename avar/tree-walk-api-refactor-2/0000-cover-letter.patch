From ac1ccf135705e449f299f181a5c0e50e856d5400 Mon Sep 17 00:00:00 2001
In-Reply-To: <20210308150650.18626-1-avarab@gmail.com>
References: <20210308150650.18626-1-avarab@gmail.com>
From: Ævar Arnfjörð Bjarmason <avarab@gmail.com>
Date: Tue, 16 Mar 2021 03:01:18 +0100
Subject: [PATCH v2 00/29] *** SUBJECT HERE ***
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

*** BLURB HERE ***

Ævar Arnfjörð Bjarmason (29):
  diff.c: remove redundant canon_mode() call
  notes & match-trees: use name_entry's "pathlen" member
  cache.h: add a comment to object_type()
  tree-walk.h: add object_type member to name_entry
  tree-walk.c: migrate to using new "object_type" field when possible
  cache.h: have base_name_compare() take "is tree?", not "mode"
  tree-walk.h users: switch object_type(...) to new .object_type
  tree.h: format argument lists of read_tree_recursive() users
  tree.h users: format argument lists in archive.c
  archive: get rid of 'stage' parameter
  tree.h API: make read_tree_fn_t take an "enum object_type"
  tree-walk.h users: migrate "p->mode &&" pattern
  tree-walk.h users: refactor chained "mode" if/else into switch
  tree-walk.h users: migrate miscellaneous "mode" to "object_type"
  merge-tree tests: test for the mode comparison in same_entry()
  merge-ort: correct reference to test in 62fdec17a11
  fsck.c: switch on "object_type" in fsck_walk_tree()
  tree-walk.h users: use temporary variable(s) for "mode"
  tree-walk.h API: formatting changes for subsequent commit
  tree-walk.h API: rename get_tree_entry() to get_tree_entry_mode()
  tree-walk.h API users: use "tmp" for mode in shift_tree_by()
  tree-walk.h API: add get_tree_entry_type()
  tree-walk.h API: document and format tree_entry_extract()
  tree-entry.h API: rename tree_entry_extract() to
    tree_entry_extract_mode()
  tree-walk.h API: add a tree_entry_extract_all() function
  tree-walk.h API: add get_tree_entry_all()
  tree-walk.h API: add a get_tree_entry_path() function
  blame: emit a better error on 'git blame directory'
  tree-walk.h API: add a tree_entry_extract_type() function

 archive.c                       | 50 +++++++++---------
 blame.c                         |  9 ++--
 builtin/checkout.c              |  6 ++-
 builtin/fast-import.c           |  8 +--
 builtin/grep.c                  |  6 +--
 builtin/log.c                   |  7 +--
 builtin/ls-files.c              |  6 ++-
 builtin/ls-tree.c               | 14 +++---
 builtin/merge-tree.c            | 30 +++++++----
 builtin/mktree.c                |  4 +-
 builtin/pack-objects.c          |  6 +--
 builtin/reflog.c                |  3 +-
 builtin/rm.c                    |  2 +-
 builtin/update-index.c          |  6 ++-
 cache-tree.c                    |  2 +-
 cache.h                         | 11 ++--
 combine-diff.c                  |  8 +--
 delta-islands.c                 |  2 +-
 diff.c                          |  2 +-
 fsck.c                          | 23 ++++-----
 http-push.c                     |  6 ++-
 line-log.c                      |  2 +-
 list-objects.c                  | 20 +++++---
 match-trees.c                   | 52 +++++++++----------
 merge-ort.c                     | 13 ++---
 merge-recursive.c               | 33 ++++++------
 notes.c                         | 14 +++---
 object-name.c                   |  7 ++-
 pack-bitmap-write.c             |  8 +--
 read-cache.c                    | 16 +++---
 revision.c                      | 12 +++--
 t/t4300-merge-tree.sh           | 44 ++++++++++++++++
 t/t8004-blame-with-conflicts.sh | 20 ++++++++
 tree-diff.c                     | 30 +++++++----
 tree-walk.c                     | 89 ++++++++++++++++++++++++---------
 tree-walk.h                     | 63 ++++++++++++++++++++---
 tree.c                          | 19 ++++---
 tree.h                          |  5 +-
 unpack-trees.c                  | 24 +++++----
 walker.c                        | 22 ++++----
 40 files changed, 460 insertions(+), 244 deletions(-)

Range-diff:
 1:  a093f0ba956 <  -:  ----------- l10n: ru.po: update Russian translation
 2:  684dd4c2b41 <  -:  ----------- checkout: fix bug that makes checkout follow symlinks in leading path
 3:  0d58fef58a6 <  -:  ----------- run-command: invalidate lstat cache after a command finished
 4:  22539ec3b5e <  -:  ----------- unpack_trees(): start with a fresh lstat cache
 5:  6b82d3eea62 <  -:  ----------- Git 2.17.6
 6:  6eed462c8f9 <  -:  ----------- Git 2.18.5
 7:  9fb2a1fb083 <  -:  ----------- Git 2.19.6
 8:  8b1a5f33d3e <  -:  ----------- Git 2.20.5
 9:  c735d7470e7 <  -:  ----------- Git 2.21.4
10:  c753e2a7a8e <  -:  ----------- Git 2.22.5
11:  d60b6a96f08 <  -:  ----------- Git 2.23.4
12:  06214d171b1 <  -:  ----------- Git 2.24.4
13:  42ce4c7930f <  -:  ----------- Git 2.25.5
14:  a79fd20c716 <  -:  ----------- Git 2.26.3
15:  6ff7f460394 <  -:  ----------- Git 2.27.1
16:  e4f42998596 <  -:  ----------- Git 2.28.1
17:  0628636d0c2 <  -:  ----------- Git 2.29.3
18:  94f6e3e283f <  -:  ----------- Git 2.30.2
19:  a9926ecd54e <  -:  ----------- l10n: Update Catalan translation
20:  712b0ed6ec8 <  -:  ----------- l10n: git.pot: v2.31.0 round 1 (155 new, 89 removed)
21:  66f52fa26b4 <  -:  ----------- pack-revindex.c: don't close unopened file descriptors
22:  5ff5a306521 <  -:  ----------- l10n: fr: v2.31.0 rnd 1
23:  fa42d191c6b <  -:  ----------- l10n: pl.po: Update translation
24:  fe8885258b6 <  -:  ----------- l10n: sv.po: Update Swedish translation (5103t0f0u)
25:  3ed77c47922 <  -:  ----------- l10n: tr: v2.31.0-rc0
26:  9b7e82b9402 <  -:  ----------- l10n: git.pot: v2.31.0 round 2 (9 new, 8 removed)
27:  929dc48e963 <  -:  ----------- l10n: sv.po: Update Swedish translation (5104t0f0u)
28:  f6a7e896b8b <  -:  ----------- l10n: tr: v2.31.0-rc1
29:  068cb923003 <  -:  ----------- l10n: fr: v2.31 rnd 2
30:  2f176de687d <  -:  ----------- l10n: bg.po: Updated Bulgarian translation (5104t)
31:  8278f870221 <  -:  ----------- l10n: zh_TW.po: v2.31.0 round 2 (15 untranslated)
32:  2aec3bc4b64 <  -:  ----------- fetch-pack: do not mix --pack_header and packfile uri
33:  020534164d3 <  -:  ----------- tree.c API: move read_tree() into builtin/ls-files.c
34:  6aa6ba2fbb5 <  -:  ----------- ls-files: don't needlessly pass around stage variable
35:  4f27e5d2970 <  -:  ----------- ls-files: remove cache juggling + sorting
36:  33810d3c10c <  -:  ----------- merge-ort: move cmp_cache_name_compare() from tree.c
37:  fb10246b85b <  -:  ----------- ls-files: refactor read_one_entry_quick() to use a strbuf
38:  0c065615aec <  -:  ----------- tree.h API: remove support for starting at prefix != ""
39:  9685c7c5c50 <  -:  ----------- tree.h API: remove "stage" parameter from read_tree_recursive()
40:  8c4abfb8be4 <  -:  ----------- l10n: start Indonesian translation
41:  c21ad4d941b <  -:  ----------- l10n: Add translation team info
42:  b0adcc311ba <  -:  ----------- l10n: es: 2.31.0 round 2
43:  13699359870 <  -:  ----------- l10n: vi.po(5104t): for git v2.31.0 l10n round 2
44:  408985d301d <  -:  ----------- l10n: pt_PT: add Portuguese translations part 1
45:  834845142dd <  -:  ----------- l10n: de.po: Update German translation for Git v2.31.0
46:  13d7ab6b5d7 <  -:  ----------- Git 2.31-rc2
47:  b2a51c1b03c <  -:  ----------- mergetool: do not enable hideResolved by default
48:  53204061acb <  -:  ----------- doc: describe mergetool configuration in git-mergetool(1)
49:  473eb54151e <  -:  ----------- l10n: zh_CN: for git v2.31.0 l10n round 1 and 2
50:  a5828ae6b52 <  -:  ----------- Git 2.31
 -:  ----------- >  1:  f9bbc30f69f diff.c: remove redundant canon_mode() call
 -:  ----------- >  2:  187fc2c3e64 notes & match-trees: use name_entry's "pathlen" member
 -:  ----------- >  3:  311637c5583 cache.h: add a comment to object_type()
 -:  ----------- >  4:  fecfe3d462c tree-walk.h: add object_type member to name_entry
 -:  ----------- >  5:  db961ab5e8d tree-walk.c: migrate to using new "object_type" field when possible
 -:  ----------- >  6:  df2fc76161d cache.h: have base_name_compare() take "is tree?", not "mode"
 -:  ----------- >  7:  49d5da8c086 tree-walk.h users: switch object_type(...) to new .object_type
 -:  ----------- >  8:  c9d209d496a tree.h: format argument lists of read_tree_recursive() users
 -:  ----------- >  9:  a6d2660fe14 tree.h users: format argument lists in archive.c
 -:  ----------- > 10:  15f7f89acca archive: get rid of 'stage' parameter
 -:  ----------- > 11:  7a71404ea3f tree.h API: make read_tree_fn_t take an "enum object_type"
 -:  ----------- > 12:  64dc9364bae tree-walk.h users: migrate "p->mode &&" pattern
 -:  ----------- > 13:  93ed3edbbd5 tree-walk.h users: refactor chained "mode" if/else into switch
 -:  ----------- > 14:  7aa48aa34c3 tree-walk.h users: migrate miscellaneous "mode" to "object_type"
 -:  ----------- > 15:  3ae81621dcf merge-tree tests: test for the mode comparison in same_entry()
 -:  ----------- > 16:  4249ad5c4de merge-ort: correct reference to test in 62fdec17a11
 -:  ----------- > 17:  e5e17505dde fsck.c: switch on "object_type" in fsck_walk_tree()
 -:  ----------- > 18:  3f0b884f1fd tree-walk.h users: use temporary variable(s) for "mode"
 -:  ----------- > 19:  174167613bb tree-walk.h API: formatting changes for subsequent commit
 -:  ----------- > 20:  ec76db613f2 tree-walk.h API: rename get_tree_entry() to get_tree_entry_mode()
 -:  ----------- > 21:  11e34941729 tree-walk.h API users: use "tmp" for mode in shift_tree_by()
 -:  ----------- > 22:  b31c106557f tree-walk.h API: add get_tree_entry_type()
 -:  ----------- > 23:  304d5d4d1af tree-walk.h API: document and format tree_entry_extract()
 -:  ----------- > 24:  346453df356 tree-entry.h API: rename tree_entry_extract() to tree_entry_extract_mode()
 -:  ----------- > 25:  dd012b661e5 tree-walk.h API: add a tree_entry_extract_all() function
 -:  ----------- > 26:  b6ee8410e38 tree-walk.h API: add get_tree_entry_all()
 -:  ----------- > 27:  5c98afd9e7a tree-walk.h API: add a get_tree_entry_path() function
 -:  ----------- > 28:  3e7e0f7eb85 blame: emit a better error on 'git blame directory'
 -:  ----------- > 29:  ac1ccf13570 tree-walk.h API: add a tree_entry_extract_type() function
-- 
2.31.0.rc2.211.g1d0b8788b3

