From ac1ccf135705e449f299f181a5c0e50e856d5400 Mon Sep 17 00:00:00 2001
In-Reply-To: <20210308150650.18626-1-avarab@gmail.com>
References: <20210308150650.18626-1-avarab@gmail.com>
From: Ævar Arnfjörð Bjarmason <avarab@gmail.com>
Date: Tue, 16 Mar 2021 03:01:43 +0100
Subject: [PATCH v2 00/29] *** SUBJECT HERE ***
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

*** BLURB HERE ***

Ævar Arnfjörð Bjarmason (29):
  diff.c: remove redundant canon_mode() call
  notes & match-trees: use name_entry's "pathlen" member
  cache.h: add a comment to object_type()
  tree-walk.h: add object_type member to name_entry
  tree-walk.c: migrate to using new "object_type" field when possible
  cache.h: have base_name_compare() take "is tree?", not "mode"
  tree-walk.h users: switch object_type(...) to new .object_type
  tree.h: format argument lists of read_tree_recursive() users
  tree.h users: format argument lists in archive.c
  archive: get rid of 'stage' parameter
  tree.h API: make read_tree_fn_t take an "enum object_type"
  tree-walk.h users: migrate "p->mode &&" pattern
  tree-walk.h users: refactor chained "mode" if/else into switch
  tree-walk.h users: migrate miscellaneous "mode" to "object_type"
  merge-tree tests: test for the mode comparison in same_entry()
  merge-ort: correct reference to test in 62fdec17a11
  fsck.c: switch on "object_type" in fsck_walk_tree()
  tree-walk.h users: use temporary variable(s) for "mode"
  tree-walk.h API: formatting changes for subsequent commit
  tree-walk.h API: rename get_tree_entry() to get_tree_entry_mode()
  tree-walk.h API users: use "tmp" for mode in shift_tree_by()
  tree-walk.h API: add get_tree_entry_type()
  tree-walk.h API: document and format tree_entry_extract()
  tree-entry.h API: rename tree_entry_extract() to
    tree_entry_extract_mode()
  tree-walk.h API: add a tree_entry_extract_all() function
  tree-walk.h API: add get_tree_entry_all()
  tree-walk.h API: add a get_tree_entry_path() function
  blame: emit a better error on 'git blame directory'
  tree-walk.h API: add a tree_entry_extract_type() function

 archive.c                       | 50 +++++++++---------
 blame.c                         |  9 ++--
 builtin/checkout.c              |  6 ++-
 builtin/fast-import.c           |  8 +--
 builtin/grep.c                  |  6 +--
 builtin/log.c                   |  7 +--
 builtin/ls-files.c              |  6 ++-
 builtin/ls-tree.c               | 14 +++---
 builtin/merge-tree.c            | 30 +++++++----
 builtin/mktree.c                |  4 +-
 builtin/pack-objects.c          |  6 +--
 builtin/reflog.c                |  3 +-
 builtin/rm.c                    |  2 +-
 builtin/update-index.c          |  6 ++-
 cache-tree.c                    |  2 +-
 cache.h                         | 11 ++--
 combine-diff.c                  |  8 +--
 delta-islands.c                 |  2 +-
 diff.c                          |  2 +-
 fsck.c                          | 23 ++++-----
 http-push.c                     |  6 ++-
 line-log.c                      |  2 +-
 list-objects.c                  | 20 +++++---
 match-trees.c                   | 52 +++++++++----------
 merge-ort.c                     | 13 ++---
 merge-recursive.c               | 33 ++++++------
 notes.c                         | 14 +++---
 object-name.c                   |  7 ++-
 pack-bitmap-write.c             |  8 +--
 read-cache.c                    | 16 +++---
 revision.c                      | 12 +++--
 t/t4300-merge-tree.sh           | 44 ++++++++++++++++
 t/t8004-blame-with-conflicts.sh | 20 ++++++++
 tree-diff.c                     | 30 +++++++----
 tree-walk.c                     | 89 ++++++++++++++++++++++++---------
 tree-walk.h                     | 63 ++++++++++++++++++++---
 tree.c                          | 19 ++++---
 tree.h                          |  5 +-
 unpack-trees.c                  | 24 +++++----
 walker.c                        | 22 ++++----
 40 files changed, 460 insertions(+), 244 deletions(-)

Range-diff:
 1:  020534164d3 <  -:  ----------- tree.c API: move read_tree() into builtin/ls-files.c
 2:  6aa6ba2fbb5 <  -:  ----------- ls-files: don't needlessly pass around stage variable
 3:  4f27e5d2970 <  -:  ----------- ls-files: remove cache juggling + sorting
 4:  33810d3c10c <  -:  ----------- merge-ort: move cmp_cache_name_compare() from tree.c
 5:  fb10246b85b <  -:  ----------- ls-files: refactor read_one_entry_quick() to use a strbuf
 6:  0c065615aec <  -:  ----------- tree.h API: remove support for starting at prefix != ""
 7:  9685c7c5c50 <  -:  ----------- tree.h API: remove "stage" parameter from read_tree_recursive()
 -:  ----------- >  1:  f9bbc30f69f diff.c: remove redundant canon_mode() call
 -:  ----------- >  2:  187fc2c3e64 notes & match-trees: use name_entry's "pathlen" member
 -:  ----------- >  3:  311637c5583 cache.h: add a comment to object_type()
 -:  ----------- >  4:  fecfe3d462c tree-walk.h: add object_type member to name_entry
 -:  ----------- >  5:  db961ab5e8d tree-walk.c: migrate to using new "object_type" field when possible
 -:  ----------- >  6:  df2fc76161d cache.h: have base_name_compare() take "is tree?", not "mode"
 -:  ----------- >  7:  49d5da8c086 tree-walk.h users: switch object_type(...) to new .object_type
 -:  ----------- >  8:  c9d209d496a tree.h: format argument lists of read_tree_recursive() users
 -:  ----------- >  9:  a6d2660fe14 tree.h users: format argument lists in archive.c
 -:  ----------- > 10:  15f7f89acca archive: get rid of 'stage' parameter
 -:  ----------- > 11:  7a71404ea3f tree.h API: make read_tree_fn_t take an "enum object_type"
 -:  ----------- > 12:  64dc9364bae tree-walk.h users: migrate "p->mode &&" pattern
 -:  ----------- > 13:  93ed3edbbd5 tree-walk.h users: refactor chained "mode" if/else into switch
 -:  ----------- > 14:  7aa48aa34c3 tree-walk.h users: migrate miscellaneous "mode" to "object_type"
 -:  ----------- > 15:  3ae81621dcf merge-tree tests: test for the mode comparison in same_entry()
 -:  ----------- > 16:  4249ad5c4de merge-ort: correct reference to test in 62fdec17a11
 -:  ----------- > 17:  e5e17505dde fsck.c: switch on "object_type" in fsck_walk_tree()
 -:  ----------- > 18:  3f0b884f1fd tree-walk.h users: use temporary variable(s) for "mode"
 -:  ----------- > 19:  174167613bb tree-walk.h API: formatting changes for subsequent commit
 -:  ----------- > 20:  ec76db613f2 tree-walk.h API: rename get_tree_entry() to get_tree_entry_mode()
 -:  ----------- > 21:  11e34941729 tree-walk.h API users: use "tmp" for mode in shift_tree_by()
 -:  ----------- > 22:  b31c106557f tree-walk.h API: add get_tree_entry_type()
 -:  ----------- > 23:  304d5d4d1af tree-walk.h API: document and format tree_entry_extract()
 -:  ----------- > 24:  346453df356 tree-entry.h API: rename tree_entry_extract() to tree_entry_extract_mode()
 -:  ----------- > 25:  dd012b661e5 tree-walk.h API: add a tree_entry_extract_all() function
 -:  ----------- > 26:  b6ee8410e38 tree-walk.h API: add get_tree_entry_all()
 -:  ----------- > 27:  5c98afd9e7a tree-walk.h API: add a get_tree_entry_path() function
 -:  ----------- > 28:  3e7e0f7eb85 blame: emit a better error on 'git blame directory'
 -:  ----------- > 29:  ac1ccf13570 tree-walk.h API: add a tree_entry_extract_type() function
-- 
2.31.0.rc2.211.g1d0b8788b3

